% -*- root: 00-main.tex -*-
\section*{Discussion}
\label{sec:discussion}
% In section \nameref{sec:methods_background}, we framed our method within the current
%   state of art and defined the contributions in our approach.
% We chose active contours without edges as we were interested in the homogeneous
%   regions of diffusion properties within the brain.
% Iteratively, the active contours are updated following the instant shape gradients
%   (see \nameref{app:shape_priors} in Appendix) with a gradient descent strategy.
% The approach is valid for image processing applications in which a precise segmentation is
%   available (from an atlas or within subject anatomical data), and match any or all
%   the following circumstances:
%   i) reference and target images do not present appropriate contrasts to
%   	perform volume-based registration reliably;
%   ii) the low resolution of the target volume produces strong partial volume effects
%   	that preclude voxel-wise segmentation algorithms and hinder volume-based
%   	registration; and,
%   iii) the estimation of the unknown warping is explicitly needed and the
%     deformation field is smooth enough to be represented with a sufficient number
%   	of B-Spline kernels (i.e. the distortion in \gls*{dmri} images,
%   	object tracking in time series, etc.).
% To support our claim that images can be simultaneously segmented and registered to a
%   reference coordinate system, we conducted evaluation experiments on digital
%   simulated phantoms and real datasets.

We designed \emph{regseg} as a method to correct \gls*{dmri} data for susceptibility
  distortions.
Connectome extraction protocols generally include the acquisition of \gls*{t1} images
  to provide with prior information about anatomy with high accuracy.
Our method solves in one single step a joint problem usually addressed in two steps:
  linear registration of \gls*{t1} and \gls*{dmri} to fuse the anatomical information on
  the diffusion data, and distortions correction using extra acquisitions.
Moreover, our method does not require any additional acquisition over the minimal protocol
  that only includes \gls*{t1} and \gls*{dmri} images, a very common scenario for
  historical datasets.

\paragraph*{Accuracy tests}
We proved that active contours without edges can be used to successfully drive a
  deformation supported by B-Spline functions in digital phantoms.
We randomly deformed 4 different phantom models mimicking three homogeneous regions,
  showing contrasts generated by a publicly available \gls*{mri} simulator.
After registration with \emph{regseg} we measured the Hausdorff distance between the
  projected contours using the ground-truth warping and our estimation.
We concluded that errors are significantly lower than voxel resolution.
We also assessed the 95\% intervals, yielding an aggregated interval of distances of
  $[0.58 - 0.73]$ in the low resolution phantoms ($2.0mm$ isotropic voxel) and
  $[0.18 - 0.41]$ in the high resolution phantoms ($1.0mm$ isotropic).
These aggregated intervals by resolution take the lowest of the lower boundary
  and the highest of the upper boundary of all CIs regardless the phantom type.
Therefore, we also conclude that the error is bounded and below the half of the
  voxel spacing to illustrate the accuracy of \emph{regseg}.

\paragraph*{Application on real data}
After a preliminary experiment to demonstrate the aptness of our segmentation model
  in section \nameref{sec:res_model_and_metric}, we evaluated \emph{regseg} in
  a real environment, using the experimental framework presented in \autoref{fig:evworkflows}.
We processed 16 subjects downloaded from the \gls*{hcp} database with both \emph{regseg}
  and an in-house replication of a competing method.
This alternative approach solves distortion using \emph{b0}-to-\gls*{t2} registration.
Our method presented significantly different results (ANOVA tests are reported in
  \autoref{tab:results_real}), and the 95\% CIs revealed the high accuracy of
  \emph{regseg}.
The aggregated CI for \emph{regseg} was $[0.39 - 0.93] mm$, whereas the competing method
  yielded an aggregated CI of $[2.36 - 3.40] mm$.
Even though we carefully configured the competing method by using the same algorithm and
  extending the same settings from a widely used software, cross-comparison
  experiments are prone to the so-called instrumentation bias \citep{tustison_instrumentation_2013}.
Therefore, these results do not reflect that the \emph{regseg} software \emph{is} better than the
  competing method, but they are communicated to proof that \emph{regseg} is a solid option to
  correct \gls*{dmri} data for distortions, and any other potential application.

\paragraph*{Prospects}
Future extensions or improvements of \emph{regseg} are similar to the evolution of existing
  alternative methodologies.
Incorporating knowledge about the distortion by initializing our method with the theory-based
  correction using fieldmaps would be the most profitable.
The main pitfall using fieldmap correction is the challenging problem of unwrapping the
  range of the phase map, as it is clipped in the range $(-\pi, \pi]$.
The most extended solution to this is \emph{prelude} \citep{jenkinson_fast_2003}, and some
  alternatives have been proposed \citep{zhou_reliable_2009,daga_susceptibility_2014} to
  circumvent the inherent unreliability of the method.
The \emph{regseg} algorithm would naturally correct misregistered areas due to errors in
  phase unwrapping, and underestimations introduced by necessary smoothing
  applied to clean up field maps.
This integration has been recently applied in the \emph{b0}-to-\gls*{t2} approach
  by \cite{irfanoglu_susceptibility_2011}, studied along with the virtues of using
  nonregular B-Spline grids.
This is also a potential extension to our deformation model.

Finally, we are currently studying substitute features to build the energy functional on,
  enabling to perform \emph{regseg} directly on the raw \gls*{dmri} data.