% -*- root: 00-main.tex -*-
\section{Discussion}
\label{sec:discussion}

\paragraph*{Accuracy tests}
The hypothesis underpinning our research was that image registration can be reliably performed
  by searching for homogeneous regions in the target image that correspond to precise contours
  from an atlas, or extracted from other image (i.e. a different time step).
We proved that active contours without edges can be used to successfully drive a
  deformation supported by B-Spline functions using digital phantoms.
We randomly deformed 4 different phantom models mimicking three homogeneous regions,
  showing contrasts generated by a publicly available \gls*{mri} simulator.
After registration with \emph{regseg} we measured the Hausdorff distance between the
  projected contours using the ground-truth warping and our estimation.
We concluded that errors are significantly lower than voxel resolution.
We also assessed the 95\% \gls*{ci}, yielding an aggregate interval of
  $[0.64 - 0.66]mm$ in the low resolution phantoms ($2.0mm$ isotropic voxel) and
  $[0.34 - 0.38]mm$ in the high resolution phantoms ($1.0mm$ isotropic).
Therefore, we also conclude that the error is bounded and below the half of the
  voxel spacing to illustrate the accuracy of \emph{regseg}.

\paragraph*{Application on real data}
We designed \emph{regseg} as a method to correct \gls*{dmri} data for susceptibility
  distortions.
Applications of whole-brain tractography generally include the acquisition of \gls*{t1} images
  to provide with prior information about anatomy with high accuracy.
Our method solves in one single step a joint problem usually addressed in two steps:
  linear registration of \gls*{t1} and \gls*{dmri} to fuse the anatomical information on
  the diffusion data, and correction of distortion using extra acquisitions.
Moreover, our method does not require any additional acquisition over the minimal protocol
  that only includes \gls*{t1} and \gls*{dmri} images, a very common situation for
  historical datasets.
Beyond the proposed correction, potential applications of \emph{regseg} are atlas-based
  segmentation and tracking objects in time-series.

After a preliminary experiment to demonstrate the aptness of our segmentation model
  in section \autoref{sec:res_model_and_metric}, we evaluated \emph{regseg} in
  a real environment, using the experimental framework presented in \autoref{fig:evworkflows}.
We processed 16 subjects from the \gls*{hcp} database with both \emph{regseg}
  and an in-house replication of the \gls*{t2b} correction method.
\emph{Regseg} showed very high accuracy, with an aggregate 95\% \gls*{ci} of $[1.08-1.50]mm$,
  almost below the pixel size of $1.25mm$.
The misregistration error remaining after \emph{regseg} was significantly lower ($p < 0.01$) than the
  error corresponding to the \gls*{t2b} correction, using the one-way ANOVA test
  (\autoref{tab:results_real}).
Visual inspection of all the results (\suppl{section S5}), and the violin plots included in
  \autoref{fig:results_real}, confirmed this intuition.
Even though we carefully configured the \gls*{t2b} method by using the same algorithm and
  same settings from a widely used software, cross-comparison experiments are prone to
  the so-called \emph{instrumentation bias} \citep{tustison_instrumentation_2013}.
Therefore, these results do not show that the \emph{regseg} software \emph{is} better than the
  \gls*{t2b} method, but they are communicated to proof that \emph{regseg} is a solid option to
  correct \gls*{dmri} data for distortions, and any other potential application.

\paragraph*{Prospects}
Future improvements of \emph{regseg} possibly will follow a similar line to the evolution of 
  existing methodologies.
Incorporating knowledge about the distortion by initializing our method with the theory-based
  correction using fieldmaps may be the most cost-effective.
The main pitfall using fieldmap correction is the challenging problem of unwrapping the
  range of the phase map, as it is clipped in the range $(-\pi, \pi]$.
The most extended solution to this is \emph{prelude} \citep{jenkinson_fast_2003}, and some
  alternatives have been proposed \citep{zhou_reliable_2009,daga_susceptibility_2014} to
  circumvent the inherent unreliability of the method.
The \emph{regseg} algorithm would naturally correct misregistered areas due to errors in
  phase unwrapping, and underestimations introduced by necessary smoothing
  applied to clean up field maps.
This integration has been recently applied in the \gls*{t2b} approach
  by \cite{irfanoglu_susceptibility_2011}, also investigating the usefulness of
  nonregular B-Spline grids.
This is also a potential extension to our deformation model.

Finally, we are currently studying substitute features to build the energy functional on,
  enabling to perform \emph{regseg} directly on the raw \gls*{dmri} data.