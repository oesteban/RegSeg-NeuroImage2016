% -*- root: 00-main.tex -*-
\section{Introduction}\label{sec:introduction}
\Gls*{dmri} enables the mapping of microstructure \citep{basser_microstructural_1996}
  and connectivity \citep{craddock_imaging_2013} of the human brain \emph{in-vivo}.
It is generally acquired using \gls*{epi} schemes, since they are very fast at
  scanning a large sequence of images called \glspl*{dwi}, each sensitized with
  a gradient to probe proton diffusion in a certain orientation.
Subsequent processing involves describing the local microstructure with one available
  model, which ranges from the early \gls*{dti} proposed by \cite{basser_microstructural_1996}
  to current models such as \citep{daducci_accelerated_2015}.
The microstructural map is then used to draw the preferential orientations of diffusion
  across regions using tractography \citep{mori_threedimensional_1999}.
Finally, the streamlines found are filtered with a cortical parcellation
  to build the graph representing the corresponding structural
  network \citep{hagmann_mapping_2008}.
Since the proposal of the earliest methodologies to solve the three problems,
  there is a need for precisely identifying the anatomy on the \gls*{dmri} space.
In fact, current trends in reconstruction \citep{jeurissen_multitissue_2014} and
  tractography \citep{smith_anatomicallyconstrained_2012} are increasingly using
  structural information to improve the microstructural mapping and fiber-tracking.

The structural information required by pioneer tractography studies was a simple
  \gls*{wm} mask to provide with a termination criteria for the streamlines.
The first attempts to segment the \gls*{wm} in \gls*{dti} involved thresholding the
  \gls*{fa}\footnote{the \gls*{fa} is a scalar parameter of diffusion derived from
  the \gls*{dti}.} map.
However, the mask and subsequent analyses are highly dependent on the threshold set
  \citep{taoka_fractional_2009}.
To overcome the unreliability of \gls*{fa} thresholding, and to broaden
  \gls*{wm} segmentation to brain tissue segmentation, a large number of
  methods have been proposed using \glspl*{dwi}, the \lowb{}, and \gls*{dti}-derived
  scalar maps such as \gls*{fa}, \gls*{adc} and others \citep{zhukov_level_2003,
  rousson_level_2004,jonasson_segmentation_2005,liu_brain_2007,hadjiprocopis_unbiased_2005,
  lu_segmentation_2008,han_experimental_2009}.
However, the precise segmentation of \gls*{dmri} is difficult for several limitations.
First, \gls{dmri} images have a resolution that is much lower than that of the imaged
  microstructural features.
Therefore, voxels located in structural discontinuities are affected by partial
  voluming of the signal sources.
Second, the extremely low \gls*{snr} and the high dimensionality of the \glspl*{dwi} prevent
  their direct use in segmentation.
Third, the low contrast between \gls*{gm} and \gls*{wm} in the \lowb{} volumes also makes
  them unsuitable for brain tissue segmentation.

An alternative route to segmentation in native \gls*{dmri} space is the mapping of the
  structural information extracted from anatomical MR images, such as \gls*{t1}, through
  an image registration process.
Generally, intra-subject registration of MR images of the brain involves only a linear
  mapping to compensate for head motion between scans.
However, \gls*{epi} images speed up the acquisition process at the cost of introducing geometrical
  distortion, as well as signal degradation and destruction \citep{jezzard_correction_1995}.
The so-called \emph{\gls*{epi} distortions} have a major impact on the anatomy extracted
  from \gls*{dmri}, particularly in certain fiber bundles \citep{irfanoglu_effects_2012}.
To overcome this problem, two broad families of solutions are available.
First, it is possible to use an existing ``\gls*{epi} distortion correction''
  method to compensate for the nonlinear part of the misalignment with the structural space,
  combined with a rigid registration method.
Second, to apply a nonlinear registration method with specific constraints derived from the
  theoretical properties of the \gls*{epi} distortion.
However, both solutions require extra acquisitions to be included within the \gls*{dmri} scanning
  protocol, such as fieldmaps \citep{jezzard_correction_1995}, \glspl*{dwi} with a different
  \gls*{pe} scheme \citep{cordes_geometric_2000,chiou_simple_2000}, or \gls*{t2} images
  \citep{kybic_unwarping_2000}.
In the following, we will refer to this latter approach as \gls*{t2b} correction.
\Gls*{epi} corrections have been an active field of research, with numerous refinements and
  combinations of the original methods \citep{holland_efficient_2010,andersson_comprehensive_2012,
  irfanoglu_drbuddi_2015}

The tool \emph{bbregister} \citep{greve_accurate_2009} has been widely adopted as the standard
  registration method to be used along with the \gls*{epi} correction of choice.
It implements a linear mapping, and uses 3D active contours with edges\footnote{A three-dimensional active contour
  is a surface and it is ``with edges'' when the contours evolve in search of abrupt intensity steps
  (the edges) within the target image.} to search for intensity boundaries in the \lowb{} image.
The active contours are initialized using surfaces extracted from the \gls*{t1} using
  \emph{FreeSurfer} \citep{fischl_freesurfer_2012}: the \emph{pial} surface (exterior of the
  cortical \gls*{gm}) and the \emph{white} surface (the \gls*{wm}/\gls*{gm} interface).
The \lowb{} image only includes a detectable frontier for the pial surface, and thus
  \emph{bbregister} is limited to aligning the cortical layer in this
  application.
To overcome the problem of nonlinear distortions, \emph{bbregister} excludes the
  regions that are typically warped from the boundary search.
However, because the distortion is not considered, it must be addressed separately.
The nonlinear registration approach has been successfully solved with \gls*{t2b} methods,
  which align the \gls*{t2} and \lowb{} images by exploiting their similarity
  \citep{kybic_unwarping_2000,studholme_accurate_2000}.
However, further rigid registration of the \gls*{t1} and \gls*{t2} images is still required to
  map the anatomical information onto \gls*{dmri}-space.

Here we show a method that registers anatomically-correct surfaces to multivariate images,
  thereby implicitly segmenting the \gls*{dmri}-space into those structures enclosed by the contours
  of the subject's brain.
% It is important that surfaces are defined in the coordinate system of the image used as
%   source of structural information (typically, but not restricted to, \gls*{t1} images), otherwise segmentation performs
%   correctly but the mapping found in registration does not represent any valuable information.
The hypothesis underlying is that the registration and segmentation problems in \gls*{dmri}
  can be solved simultaneously with three key benefits:
  1) effectively establishing the necessary mapping to project structural information from anatomical images,
  2) increasing the geometrical accuracy of the overall process,
  and 3) avoiding data resampling of \gls*{epi} correction methods.
Thus, we propose a tool called \regseg{} implementing 3D active contours (surfaces) without edges
  \citep{chan_active_2001}, which evolve over a free-form deformation field of B-spline
  basis functions.
The surfaces are nested and they enclose regions with homogeneous diffusion features
  (the \gls*{fa} and \gls*{adc} maps for the case of \gls*{dmri} data).
Optimization is performed using a descent strategy with explicit shape gradients
  \citep{besson_dream2s_2003,herbulot_segmentation_2006}.
Therefore, unlike most previous methods, \regseg{} does not implement level sets.
Since the \gls*{epi} distortion is aligned with the \gls*{pe} axis (see
  \autoref{sec:human_connectome}), \regseg{} includes an anisotropic regularizer for
  the displacements field proposed by \cite{nagel_investigation_1986}.
Finally, we evaluate \regseg{} using an extension of our instrumentation framework
  \citep{esteban_simulationbased_2014}, which simulates known and realistic distortions
  based on \gls*{dmri} data.
The evaluation includes a comparison of \regseg{} to an in-house implementation of
  the \gls*{t2b} correction.
