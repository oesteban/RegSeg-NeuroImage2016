% -*- root: 00-main.tex -*-
\section{Introduction}%
\label{sec:introduction}
Image registration is the process to find a spatial mapping that aligns the information available
  in two different coordinate systems.
In their comprehensive survey, \cite{sotiras_deformable_2013} illustrated the wide variety
  of existing methodologies, and classified them by their three principal building blocks:
  the matching criteria to evaluate the proximity of the solution,
  the deformation model that may implement theoretical properties of the mapping
  (i.e. linearity, elasticity, viscosity, etc.), and the optimization method.
The matching criteria can be defined as a function on the intensities of voxels of the
  two images, the alignment of spatial features derived from the corresponding objects in
  the spaces to be registered, or use both intensity and spatial informations.
In \citep{sotiras_deformable_2013} these methods are referred to as \emph{iconic}, \emph{geometric},
  and \emph{hybrid}, respectively.
When segmentation is introduced to define the matching criteria, we face a \emph{hybrid}
  registration method that simultaneously defines a partition of the reference space to identify
  relevant objects in it.
An early integration of segmentation and registration by \cite{bertalmio_morphing_2000} proposed
  a sequential deformation of active contours for object tracking in sequential 2D images.
Shortly, \cite{yezzi_variational_2003} presented the first method including a full solution to
  the registration problem with an affine transformation supporting the coordinates mapping.
\cite{vemuri_joint_2003} proposed an atlas-based registration framework using level sets and only
  one \gls*{pde} for first time.
\cite{unal_coupled_2005} and later \cite{wang_joint_2006},
  extended the ``two \glspl*{pde}'' method of \cite{yezzi_variational_2003}
  to nonlinear registration implementing a free deformation field.
\cite{droske_mumfordshah_2009} reviewed the latter set of techniques, and proposed two different
  approaches to apply the Mumford-Shah functional \citep{mumford_optimal_1989} in simultaneous
  registration and segmentation, through the propagation of the deformation field from
  the contours to the whole image definition.
\cite{greve_accurate_2009} presented a widely used registration method called \emph{bbregister},
  included in \emph{FreeSurfer} \citep{fischl_freesurfer_2012}.
Their framework performs robust registration of brain surfaces into the intensity information
  of a target \gls*{mri}, using an affine transformation and active contours with edges.
Recently, \cite{guyader_combined_2011} proposed a simultaneous segmentation and
  registration method using level sets and a nonlinear elasticity smoother on the
  displacement vector field, which preserves topology even with very large deformations.
Finally, \cite{gorthi_active_2011} extended the existing methodologies using a multiphase
  level-set function for the registration of several active contours, in the application
  of atlas-based segmentation.
Alternatively to the historical use of active contours, some Bayesian approaches
  have been proposed as well \citep{wyatt_map_2003,pohl_bayesian_2006,gass_simultaneous_2014}.

We propose \emph{regseg}, a registration method based on active contours without edges
  \citep{chan_active_2001} to drive registration and segment the target image.
The hypothesis underpinning our research is that image registration can be reliably performed
  by searching for homogeneous regions in the target image that correspond to precise contours
  from an atlas, or extracted from other image (i.e. a different time step).
We demonstrate the approach in correcting \gls*{dmri} for nonlinear distortions, an application
  that is described in \autoref{sec:distortions}.
In \autoref{sec:methods_map}, we start from a probabilistic framework to finally show the duality
  between the methods described previously.
Following sections introduce
  the specific features of \emph{regseg} (\autoref{sec:numerical_implementation}),
  state the evaluation experiments (\autoref{sec:experiments_evaluation}),
  and describe the synthetic and real data involved in this study (\autoref{sec:datasets}).
In \autoref{sec:results} we describe our findings to support the usefulness of \emph{regseg}
  in the described application, compared to a well-established tool.
The interpretation of the results, and prospects, are addressed in \autoref{sec:discussion}.


