% -*- root: 00-main.tex -*-
\section{Introduction}\label{sec:introduction}
The accurate delineation of \gls*{wm} in \gls*{dmri} and the fusion of prior
  anatomical information extracted from a \gls*{t1} image of the same subject
  are crucial in a range of applications based on tractography, such as
  the extraction of structural connectivity \citep{craddock_imaging_2013} or
  tract-based spatial statistics \citep{smith_tractbased_2006}.
However, segmenting \gls*{dmri} data precisely and coregistration of anatomical
  images are difficult for several reasons.
First, \gls{dmri} images suffer from partial voluming of several tissues in 
  interfacing voxels due to the low resolution of images (generally around
  \isores[mm]{2.2}).
Second, \gls*{dmri} schemes probe the diffusion process within the brain in 
  many angles called \glspl*{dwi}, completed by one or more baseline (\emph{b0}) 
  volumes without directional gradients.
The extremely low \gls*{snr} and high dimensionality of \glspl*{dwi} disable their
  use for direct segmentation.
The low contrast between \gls*{gm} and \gls*{wm} in the \emph{b0} volumes is not suitable for 
  segmentation either.
Lastly, \gls*{dmri} images are acquired using \gls*{epi} to speed up acquisition
  at the cost of presenting geometrical distortion and 
  signal losses \citep{jezzard_correction_1995} that hinder the segmentation by
  registering an anatomical image as source of same-subject prior information.
The artifact has been proven to cause an important impact on the anatomy extracted
  from \gls*{dmri} \citep{irfanoglu_effects_2012}, particularly in certain fiber bundles
  when used in whole-brain tractography.

Early attempts to delineate the \gls*{wm} proceeded by thresholding the 
  \gls*{fa}\footnote{the \gls*{fa} is a scalar parameter of diffusion derived from
  the \gls*{dmri} data.} map.
However, the mask and subsequent analyses substantially depend on the threshold set
  \citep{taoka_fractional_2009} owing to the large variability of \gls*{fa} and its
  decay with the increase of incoherence between fibers.
\cite{zhukov_level_2003} proposed active contours with edges represented
  by levelsets, evolving on directionally invariant scalar maps.
\cite{rousson_level_2004} successfully segmented the corpus callosum with
  region-based levelsets on the eigenvalues of tensors fitted on the
  \gls*{dmri} data.
A large body of work targeted the definition of appropriate features to cluster,
  such as the 5D representation proposed by \cite{jonasson_segmentation_2005}.
Other efforts include mixture models on sets of directionally invariant maps
  \citep{liu_brain_2007}, iterative \citep{hadjiprocopis_unbiased_2005} and
  hierarchical \citep{lu_segmentation_2008} clusterings,
  and graph-cuts \citep{han_experimental_2009},
  and volume fraction modeling \citep{kumazawa_improvement_2013}.
 
To solve the segmentation problem through registration, \cite{saad_new_2009} 
  used Pearson correlation to perform linear alignment of the \gls*{t1} and 
  the \emph{b0}.
Similarly, an also linear registration method is \emph{bbregister} \citep{greve_accurate_2009}.
It uses active contours with edges to look for intensity boundaries in the \emph{b0}
  image.
The active contours are initialized by surfaces extracted from the 
  \gls*{t1} using \emph{FreeSurfer} \citep{fischl_freesurfer_2012}:
  the \emph{pial} surface (exterior of cortical \gls*{gm}) and the \emph{white}
  surface (the \gls*{wm}/\gls*{gm} interface). 
Since the \emph{b0} image only presents a detectable frontier for the pial surface,
  \emph{bbregister} is limited to align the cortical layer in this
  application.
This tool has become the standard method for its proven robustness, despite the 
  distortions found in \gls*{dmri} are nonlinear.
To overcome this issue, \emph{bbregister} excludes from the boundary search those
  regions typically warped by the artifact.
As the distortion is not accounted for, it should be addressed separately.
Nonlinear registration has been successfully performed between \gls*{t2} and \emph{b0}
  images for their similarity, but uniquely as a way to correct for distortions
  \citep{kybic_unwarping_2000,studholme_accurate_2000,wu_comparison_2008,tao_variational_2009}.
Further registration of \gls*{t1} and \gls*{t2} images was still required to map the anatomical
  information (and the \gls*{wm} segmentation) into \gls*{dmri} space.

Therefore, given the described circumstances, a method performing simultaneously
  segmentation in \gls*{dmri} space and registration of the corresponding \gls*{t1} image
  to the \gls*{dmri} data could provide the optimal solution.
Previously, joint segmentation and registration has been successfully applied to
  longitudinal object tracking \citep{paragios_level_2003} and atlas-based
  segmentation \citep{gorthi_active_2011}.
The most extended approach is integrating active contours in image registration 
  methods.
\cite{unal_coupled_2005} and later \cite{wang_joint_2006},
  improved an existing method \citep{yezzi_variational_2003} based on linear registration
  to the nonlinear case implementing a free-form deformation field.
\cite{droske_mumfordshah_2009} reviewed the existing techniques, and proposed two different
  approaches to apply the Mumford-Shah functional \citep{mumford_optimal_1989} in simultaneous
  registration and segmentation, through the propagation of the deformation field from
  the contours to the whole image definition.
Recently, \cite{guyader_combined_2011} proposed a simultaneous segmentation and
  registration method in 2D using levelsets and a nonlinear elasticity smoother on the
  displacement vector field, which preserves topology even with very large deformations.
Finally, \cite{gorthi_active_2011} extended the existing methodologies using a multiphase
  levelset function for the registration of several active contours, in the application
  of atlas-based segmentation.
  
The hypothesis under this research is that the registration and segmentation
  problems in \gls*{dmri} can be solved simultaneously, increasing the geometrical
  accuracy of the process.
We propose a tool called \emph{regseg} to exploit the prior information of shapes
  extracted on \gls*{t1} images to register the anatomical reference
  to \gls*{dmri} space, implicitly segmenting these data.
The approach uses active contours without edges \citep{chan_active_2001} that evolve driving a
  free-form deformation field of B-Spline basis functions.
Optimization is performed using a descent strategy of explicit shape-gradients
  \citep{besson_dream2s_2003,herbulot_segmentation_2006}, therefore \emph{regseg}
  does not implement levelsets as most of the presented methods.
Since the nonlinear distortion is aligned with one of the imaging axis (see 
  \autoref{sec:human_connectome}), \emph{regseg} includes an anisotropic regularizer of
  the displacements field proposed by \cite{nagel_investigation_1986}.
Finally, we evaluate \emph{regseg} using an extension of our instrumentation framework
  \citep{esteban_simulationbased_2014} that simulates known and realistic distortions
  on \gls*{dmri} data.
The evaluation includes a comparison to the \gls*{t2b} correction by integrating in the framework
  an in-house implementation of the method.
